# Bitbucket Repo Access

Connecting to Bitbucket's build status API allows repository events to trigger Buildkite builds. Events such as creating or updating a PR triggers the creation of a new build in the associated Buildkite pipeline. After the build completes in Buildkite, the status icon in Bitbucket will update to reflect the outcome. 

There are two parts to connecting Buildkite and Bitbucket, the first in Buildkite and the second in Bitbucket.   

<%= toc %>

## Connecting Buildkite to Bitbucket

Connecting Bitbucket as an app in Buildkite will allow webhooks from Bitbucket access to your Buildkite account.

In Buildkite, go to Personal Settings > Connected Apps > Bitbucket and click Connect
<%= image "personal-settings.png", width: 1938/2, height: 382/2, alt: "Screenshot of the Buildkite Connected Apps screen" %>

You can edit the Bitbucket settings for specific pipelines from the settings page of any pipeline using a Bitbucket repository. 

<%= image "bitbucket-settings.png", width: 1938/2, height: 942/2, alt: "Screenshot of the Buildkite Bitbucket settings" %>

## Setting up a Bitbucket webhook

This webhook will be triggered by the repository events that you specify, and will hit your unique Buildkite API endpoint to create a Buildkite build.

1. Visit your Bitbucket repository's 'Webhooks Settings' page
1. Click the 'Add Webhook' button and enter your Buildkite organization and pipeline name, as well as your unique Buildkite webhook URL
1. From the list of triggers, select the Repository Push event, and the following Pull Request Events:
	* Created
	* Updated
	* Approved
	* Approval Removed
	* Merged
	* Declined 

Once you've filled it out, the form should look like this:
<%= image "webhook-form.png", width: 930/2, height: 1578/2, alt: "Screenshot of a completed Bitbucket webhook form" %>

Click the `save` button, and the webhook will be created. Set up a Buildkite pipeline using this repository's url, and the repository events that you selected will trigger the creation of Buildkite builds ðŸŽ‰

As you set up a new Buildkite pipeline with a Bitbucket repository, we'll display these instructions again, populated with your unique account details. 
